{"ast":null,"code":"import _objectSpread from\"/Users/shannoncoakley/Documents/GitHub/mp/memberportal/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/shannoncoakley/Documents/GitHub/mp/memberportal/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/shannoncoakley/Documents/GitHub/mp/memberportal/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/shannoncoakley/Documents/GitHub/mp/memberportal/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import{Button,Form,Input,message}from'antd';import{useNavigate}from\"react-router-dom\";import{ReactComponent as LogoImg}from'../../images/svgIcons/do_good_logo_login.svg';import styles from'./style.module.sass';import{fetchDataFromSalesForce}from\"../../salesforceAuth\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var onFinishFailed=function onFinishFailed(errorInfo){console.log('Failed:',errorInfo);};var Login=function Login(){var _useState=useState({email:'',password:''}),_useState2=_slicedToArray(_useState,2),formData=_useState2[0],setFormData=_useState2[1];var _message$useMessage=message.useMessage(),_message$useMessage2=_slicedToArray(_message$useMessage,2),messageApi=_message$useMessage2[0],contextHolder=_message$useMessage2[1];var _useState3=useState({to:'scoakley@mydogood.com',subject:'Need help logging into member portal',body:'I need help logging into the DoGood member portal.'}),_useState4=_slicedToArray(_useState3,2),emailData=_useState4[0],setEmailData=_useState4[1];var error=function error(){messageApi.open({type:'error',content:'Click the \"Need help logging in?'});};var navigate=useNavigate();useEffect(function(){var storedClientId=localStorage.getItem('clientId');if(storedClientId){navigate(\"/\".concat(storedClientId,\"/profile\"),{replace:true});}},[]);var onFinish=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(values){var query,salesForceData,clientId;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;query=\"query/?q=SELECT+Id,Email,Member_Portal_Password__c+FROM+Contact+WHERE+RecordTypeId='01236000000yGps'+AND+(Membership_Status__c='Active'+OR+Membership_Status__c='Testing')+AND+Email='\".concat(formData.email,\"'+AND+Member_Portal_Password__c='\").concat(formData.password,\"'\");_context.next=4;return fetchDataFromSalesForce(\"\".concat(query));case 4:salesForceData=_context.sent;if(salesForceData.records.length===1){clientId=salesForceData.records[0].Id;localStorage.setItem('clientId',clientId);navigate(\"/\".concat(clientId,\"/home\"),{replace:true});}else{error();}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);alert('Authorization error. Please try again later.');case 11:case\"end\":return _context.stop();}},_callee,null,[[0,8]]);}));return function onFinish(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"section\",{className:styles.loginSection,children:[contextHolder,/*#__PURE__*/_jsxs(\"article\",{className:styles.formSection,children:[/*#__PURE__*/_jsx(LogoImg,{}),/*#__PURE__*/_jsx(\"h1\",{className:styles.title,children:\"Log in\"}),/*#__PURE__*/_jsx(\"div\",{className:styles.formContainer,children:/*#__PURE__*/_jsxs(Form,{className:styles.form,name:\"basic\",layout:'vertical',initialValues:{remember:true},onFinish:onFinish,onFinishFailed:onFinishFailed,autoComplete:\"off\",children:[/*#__PURE__*/_jsx(Form.Item,{className:styles.formItem,label:\"Email\",name:\"email\",rules:[{message:'Please input your username!'}],children:/*#__PURE__*/_jsx(Input,{placeholder:'Enter your email associated with DoGood',onChange:function onChange(e){return setFormData(_objectSpread(_objectSpread({},formData),{},{email:e.target.value}));}})}),/*#__PURE__*/_jsx(Form.Item,{className:styles.formItem,label:\"Password\",name:\"password\",rules:[{message:'Please input your password!'}],children:/*#__PURE__*/_jsx(Input.Password,{placeholder:'Enter your password',onChange:function onChange(e){return setFormData(_objectSpread(_objectSpread({},formData),{},{password:e.target.value}));}})}),/*#__PURE__*/_jsx(\"a\",{className:styles.helpLink,href:\"mailto:\".concat(emailData.to,\"?subject=\").concat(emailData.subject,\"&body=\").concat(emailData.body),target:\"_blank\",children:\"Need help logging in?\"}),/*#__PURE__*/_jsx(Form.Item,{children:/*#__PURE__*/_jsx(Button,{className:styles.btn,type:\"primary\",htmlType:\"submit\",children:\"Log in\"})})]})})]})]});};export default Login;","map":{"version":3,"names":["React","useEffect","useState","Button","Form","Input","message","useNavigate","ReactComponent","LogoImg","styles","fetchDataFromSalesForce","jsx","_jsx","jsxs","_jsxs","onFinishFailed","errorInfo","console","log","Login","_useState","email","password","_useState2","_slicedToArray","formData","setFormData","_message$useMessage","useMessage","_message$useMessage2","messageApi","contextHolder","_useState3","to","subject","body","_useState4","emailData","setEmailData","error","open","type","content","navigate","storedClientId","localStorage","getItem","concat","replace","onFinish","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","values","query","salesForceData","clientId","wrap","_callee$","_context","prev","next","sent","records","length","Id","setItem","t0","alert","stop","_x","apply","arguments","className","loginSection","children","formSection","title","formContainer","form","name","layout","initialValues","remember","autoComplete","Item","formItem","label","rules","placeholder","onChange","e","_objectSpread","target","value","Password","helpLink","href","btn","htmlType"],"sources":["/Users/shannoncoakley/Documents/GitHub/mp/memberportal/src/components/login/Login.tsx"],"sourcesContent":["import React, {FC, useEffect, useState} from 'react';\nimport { Button, Checkbox, Form, Input, message } from 'antd';\nimport {useNavigate, useParams} from \"react-router-dom\";\nimport {useMediaQuery} from \"react-responsive\";\nimport {ReactComponent as LogoImg} from '../../images/svgIcons/do_good_logo_login.svg'\nimport styles from './style.module.sass'\nimport {fetchDataFromSalesForce} from \"../../salesforceAuth\";\n\n\nconst onFinishFailed = (errorInfo: any) => {\n    console.log('Failed:', errorInfo);\n};\n\ntype FieldType = {\n    email?: string;\n    password?: string;\n};\n\ninterface Login {\n    key: string\n}\n\nconst Login: FC = () => {\n    const [formData, setFormData] = useState({ email: '', password: '' });\n    const [messageApi, contextHolder] = message.useMessage();\n    const [emailData, setEmailData] = useState({\n        to: 'scoakley@mydogood.com',\n        subject: 'Need help logging into member portal',\n        body: 'I need help logging into the DoGood member portal.',\n    });\n\n    const error = () => {\n        messageApi.open({\n            type: 'error',\n            content: 'Click the \"Need help logging in?',\n        });\n    };\n\n    const navigate = useNavigate();\n\n    useEffect(() => {\n        const storedClientId = localStorage.getItem('clientId');\n\n        if (storedClientId) {\n            navigate(`/${storedClientId}/profile`, { replace: true });\n        }\n    }, []);\n\n\n    const onFinish = async (values: any) => {\n        try {\n            const query = `query/?q=SELECT+Id,Email,Member_Portal_Password__c+FROM+Contact+WHERE+RecordTypeId='01236000000yGps'+AND+(Membership_Status__c='Active'+OR+Membership_Status__c='Testing')+AND+Email='${formData.email}'+AND+Member_Portal_Password__c='${formData.password}'`;\n            const salesForceData = await fetchDataFromSalesForce(`${query}`);\n\n            if (salesForceData.records.length === 1) {\n                const clientId = salesForceData.records[0].Id;\n                localStorage.setItem('clientId', clientId);\n                navigate(`/${clientId}/home`, {replace: true});\n            } else {\n                error()\n            }\n        } catch (error) {\n            alert('Authorization error. Please try again later.');\n        }\n    };\n\n    return (\n        <section className={styles.loginSection}>\n            {contextHolder}\n            <article className={styles.formSection}>\n                <LogoImg/>\n                <h1 className={styles.title}>Log in</h1>\n                <div className={styles.formContainer}>\n                    <Form\n                        className={styles.form}\n                        name=\"basic\"\n                        layout={'vertical'}\n                        initialValues={{ remember: true }}\n                        onFinish={onFinish}\n                        onFinishFailed={onFinishFailed}\n                        autoComplete=\"off\"\n                    >\n                        <Form.Item<FieldType>\n                            className={styles.formItem}\n                            label=\"Email\"\n                            name=\"email\"\n                            rules={[{ message: 'Please input your username!' }]}\n                        >\n                            <Input placeholder={'Enter your email associated with DoGood'} onChange={(e) => setFormData({ ...formData, email: e.target.value })} />\n                        </Form.Item>\n\n                        <Form.Item<FieldType>\n                            className={styles.formItem}\n                            label=\"Password\"\n                            name=\"password\"\n                            rules={[{ message: 'Please input your password!' }]}\n                        >\n                            <Input.Password placeholder={'Enter your password'} onChange={(e) => setFormData({ ...formData, password: e.target.value })} />\n                        </Form.Item >\n                        <a\n                            className={styles.helpLink}\n                            href={`mailto:${emailData.to}?subject=${emailData.subject}&body=${emailData.body}`}\n                            target=\"_blank\"\n                        >\n                            Need help logging in?\n                        </a>\n                        <Form.Item>\n                            <Button className={styles.btn} type=\"primary\" htmlType=\"submit\">\n                                Log in\n                            </Button>\n                        </Form.Item>\n                    </Form>\n                </div>\n            </article>\n        </section>\n    );\n};\n\nexport default Login;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}