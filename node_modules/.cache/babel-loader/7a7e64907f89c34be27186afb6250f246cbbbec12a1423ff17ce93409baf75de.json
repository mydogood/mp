{"ast":null,"code":"import axios from \"axios\";\nimport qs from \"qs\";\nconst CLIENT_ID = \"3MVG9uudbyLbNPZNMgo7YG07X4w.bR5HADiTZbscSN3vFmxXWWQ0YPq2akjxE32VRCLhZsfZ8R0UmQ4mPVfkd\";\nconst CLIENT_SECRET = \"64E366FD9060A3FDE31A7E15DC2F3FF41B28B6674720C0995EE5E4CB280859CD\";\nconst USERNAME = \"eugeniy@bncom.test\";\nconst PASSWORD = \"AD0819llANnnjbEd03a0K6nI387dSzTfm\";\nconst LOGIN_URL = \"https://bncomtest-dev-ed.develop.my.salesforce.com/services/data/v58.0/\";\nconst REFRESH_TOKEN = \"5Aep861QbHyftz0nI_frvZE7krnzpmXRZGEmK3oh6m3eon3ZQNv6suCmHQytjRybGZHJpPlsn.696N.ZHiWMxVM\";\nconst INITIAL_ACCESS_TOKEN = \"00D36000000pFo4!AQcAQB.TsAThh5LGfnGkSK5Gu9CMlGVraIvL6yUd_lUexen2ZkAPL7YJj.k8n.d7q_x7rigTMAYKwIAsSi1G.aV3k53AaOrR\";\nconst SALESFORCE_API_BASE_URL = \"https://mydogood.my.salesforce.com/services/data/v58.0/\";\nconst SALESFORCE_TOKEN_ENDPOINT = \"https://mydogood.my.salesforce.com/services/oauth2/token\";\nconst salesforceApi = axios.create({\n  baseURL: SALESFORCE_API_BASE_URL,\n  headers: {\n    Authorization: `Bearer ${INITIAL_ACCESS_TOKEN}`\n  }\n});\nconst getNewAccessToken = async () => {\n  try {\n    const response = await axios.post(SALESFORCE_TOKEN_ENDPOINT, qs.stringify({\n      grant_type: \"refresh_token\",\n      client_id: CLIENT_ID,\n      client_secret: CLIENT_SECRET,\n      refresh_token: REFRESH_TOKEN\n    }), {\n      headers: {\n        \"Content-Type\": \"application/x-www-form-urlencoded\"\n      }\n    });\n    return response.data.access_token;\n  } catch (error) {\n    console.error(\"Error refreshing Salesforce token:\", error);\n    throw error;\n  }\n};\nexport const fetchDataFromSalesForce = async endpoint => {\n  try {\n    const response = await salesforceApi.get(endpoint);\n    return response.data;\n  } catch (error) {\n    // Checking if the error is an object AxiosError\n    if (axios.isAxiosError(error)) {\n      if (error.response && error.response.status === 401) {\n        const newAccessToken = await getNewAccessToken();\n        salesforceApi.defaults.headers[\"Authorization\"] = `Bearer ${newAccessToken}`;\n        const response = await salesforceApi.get(endpoint);\n        return response.data;\n      }\n      console.error(\"Error fetching data from SalesForce:\", error);\n    } else {\n      console.error(\"Unknown error occurred:\", error);\n    }\n    throw error;\n  }\n};\nexport const updateDataInSalesForce = async (endpoint, data) => {\n  try {\n    const response = await salesforceApi.patch(endpoint, data);\n    return response.data;\n  } catch (error) {\n    if (axios.isAxiosError(error)) {\n      if (error.response && error.response.status === 401) {\n        const newAccessToken = await getNewAccessToken();\n        salesforceApi.defaults.headers[\"Authorization\"] = `Bearer ${newAccessToken}`;\n        const response = await salesforceApi.patch(endpoint, data);\n        return response.data;\n      }\n      console.error(\"Error updating data in SalesForce:\", error);\n    } else {\n      console.error(\"Unknown error occurred:\", error);\n    }\n    throw error;\n  }\n};\nexport const createDataInSalesForce = async (endpoint, data) => {\n  try {\n    const response = await salesforceApi.post(endpoint, data);\n    return response.data;\n  } catch (error) {\n    if (axios.isAxiosError(error)) {\n      if (error.response && error.response.status === 401) {\n        const newAccessToken = await getNewAccessToken();\n        salesforceApi.defaults.headers[\"Authorization\"] = `Bearer ${newAccessToken}`;\n        const response = await salesforceApi.post(endpoint, data);\n        return response.data;\n      }\n      console.error(\"Error creating data in SalesForce:\", error);\n    } else {\n      console.error(\"Unknown error occurred:\", error);\n    }\n    throw error;\n  }\n};","map":{"version":3,"names":["axios","qs","CLIENT_ID","CLIENT_SECRET","USERNAME","PASSWORD","LOGIN_URL","REFRESH_TOKEN","INITIAL_ACCESS_TOKEN","SALESFORCE_API_BASE_URL","SALESFORCE_TOKEN_ENDPOINT","salesforceApi","create","baseURL","headers","Authorization","getNewAccessToken","response","post","stringify","grant_type","client_id","client_secret","refresh_token","data","access_token","error","console","fetchDataFromSalesForce","endpoint","get","isAxiosError","status","newAccessToken","defaults","updateDataInSalesForce","patch","createDataInSalesForce"],"sources":["/Users/shannoncoakley/Documents/GitHub/mp/src/salesforceAuth.ts"],"sourcesContent":["import axios from \"axios\";\nimport qs from \"qs\";\n\nconst CLIENT_ID =\n  \"3MVG9uudbyLbNPZNMgo7YG07X4w.bR5HADiTZbscSN3vFmxXWWQ0YPq2akjxE32VRCLhZsfZ8R0UmQ4mPVfkd\";\nconst CLIENT_SECRET =\n  \"64E366FD9060A3FDE31A7E15DC2F3FF41B28B6674720C0995EE5E4CB280859CD\";\nconst USERNAME = \"eugeniy@bncom.test\";\nconst PASSWORD = \"AD0819llANnnjbEd03a0K6nI387dSzTfm\";\nconst LOGIN_URL =\n  \"https://bncomtest-dev-ed.develop.my.salesforce.com/services/data/v58.0/\";\nconst REFRESH_TOKEN =\n  \"5Aep861QbHyftz0nI_frvZE7krnzpmXRZGEmK3oh6m3eon3ZQNv6suCmHQytjRybGZHJpPlsn.696N.ZHiWMxVM\";\nconst INITIAL_ACCESS_TOKEN =\n  \"00D36000000pFo4!AQcAQB.TsAThh5LGfnGkSK5Gu9CMlGVraIvL6yUd_lUexen2ZkAPL7YJj.k8n.d7q_x7rigTMAYKwIAsSi1G.aV3k53AaOrR\";\nconst SALESFORCE_API_BASE_URL =\n  \"https://mydogood.my.salesforce.com/services/data/v58.0/\";\nconst SALESFORCE_TOKEN_ENDPOINT =\n  \"https://mydogood.my.salesforce.com/services/oauth2/token\";\ninterface SalesforceAuthResponse {\n  access_token: string;\n}\n\nconst salesforceApi = axios.create({\n  baseURL: SALESFORCE_API_BASE_URL,\n  headers: {\n    Authorization: `Bearer ${INITIAL_ACCESS_TOKEN}`,\n  },\n});\n\nconst getNewAccessToken = async (): Promise<string> => {\n  try {\n    const response = await axios.post(\n      SALESFORCE_TOKEN_ENDPOINT,\n      qs.stringify({\n        grant_type: \"refresh_token\",\n        client_id: CLIENT_ID,\n        client_secret: CLIENT_SECRET,\n        refresh_token: REFRESH_TOKEN,\n      }),\n      {\n        headers: {\n          \"Content-Type\": \"application/x-www-form-urlencoded\",\n        },\n      }\n    );\n    return response.data.access_token;\n  } catch (error) {\n    console.error(\"Error refreshing Salesforce token:\", error);\n    throw error;\n  }\n};\n\nexport const fetchDataFromSalesForce = async (endpoint: string) => {\n  try {\n    const response = await salesforceApi.get(endpoint);\n    return response.data;\n  } catch (error) {\n    // Checking if the error is an object AxiosError\n    if (axios.isAxiosError(error)) {\n      if (error.response && error.response.status === 401) {\n        const newAccessToken = await getNewAccessToken();\n        salesforceApi.defaults.headers[\n          \"Authorization\"\n        ] = `Bearer ${newAccessToken}`;\n        const response = await salesforceApi.get(endpoint);\n        return response.data;\n      }\n      console.error(\"Error fetching data from SalesForce:\", error);\n    } else {\n      console.error(\"Unknown error occurred:\", error);\n    }\n    throw error;\n  }\n};\n\nexport const updateDataInSalesForce = async (endpoint: string, data: any) => {\n  try {\n    const response = await salesforceApi.patch(endpoint, data);\n    return response.data;\n  } catch (error) {\n    if (axios.isAxiosError(error)) {\n      if (error.response && error.response.status === 401) {\n        const newAccessToken = await getNewAccessToken();\n        salesforceApi.defaults.headers[\n          \"Authorization\"\n        ] = `Bearer ${newAccessToken}`;\n        const response = await salesforceApi.patch(endpoint, data);\n        return response.data;\n      }\n      console.error(\"Error updating data in SalesForce:\", error);\n    } else {\n      console.error(\"Unknown error occurred:\", error);\n    }\n    throw error;\n  }\n};\n\nexport const createDataInSalesForce = async (endpoint: string, data: any) => {\n  try {\n    const response = await salesforceApi.post(endpoint, data);\n    return response.data;\n  } catch (error) {\n    if (axios.isAxiosError(error)) {\n      if (error.response && error.response.status === 401) {\n        const newAccessToken = await getNewAccessToken();\n        salesforceApi.defaults.headers[\n          \"Authorization\"\n        ] = `Bearer ${newAccessToken}`;\n        const response = await salesforceApi.post(endpoint, data);\n        return response.data;\n      }\n      console.error(\"Error creating data in SalesForce:\", error);\n    } else {\n      console.error(\"Unknown error occurred:\", error);\n    }\n    throw error;\n  }\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}