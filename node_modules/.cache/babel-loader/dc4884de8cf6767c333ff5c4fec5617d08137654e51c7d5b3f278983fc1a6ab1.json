{"ast":null,"code":"import _objectWithoutProperties from\"/Users/shannoncoakley/Documents/GitHub/mp/memberportal/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";import _regeneratorRuntime from\"/Users/shannoncoakley/Documents/GitHub/mp/memberportal/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/shannoncoakley/Documents/GitHub/mp/memberportal/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"/Users/shannoncoakley/Documents/GitHub/mp/memberportal/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"/Users/shannoncoakley/Documents/GitHub/mp/memberportal/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/shannoncoakley/Documents/GitHub/mp/memberportal/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";var _excluded=[\"key\"];import React,{useEffect,useState}from\"react\";import{useMediaQuery}from\"react-responsive\";import{Button,Checkbox,Col,Dropdown,Image,Menu,Row,Space}from\"antd\";import{useGetPartnersAndIncentivesContext,useIncentivesContext}from\"../homeSection/contexts/IncentivesContext\";import{ReactComponent as Filter}from\"../../../images/svgIcons/filter.svg\";import{v4 as uuidv4}from\"uuid\";import styles from\"./styles.module.sass\";import{DownOutlined,StarFilled,StarOutlined}from\"@ant-design/icons\";import SelectedIncentivesDrawer from\"./SelectedIncentivesDrawer\";import{useParams}from\"react-router-dom\";import{createDataInSalesForce,fetchDataFromSalesForce,updateDataInSalesForce}from\"../../../salesforceAuth\";import IncentiveCustomizationDrawer from\"./IncentiveCustomizationDrawer\";import{getMemberInfoFromContact}from\"../../../getSalesForceData\";import CharityDrawer from\"./CharityDrawer\";import Link from\"antd/es/typography/Link\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var NumberWithCommas=function NumberWithCommas(x){return x===null||x===void 0?void 0:x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g,\",\");};var SelectedIncentivesSection=function SelectedIncentivesSection(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),selectCartItemId=_useState2[0],setSelectCartItemId=_useState2[1];var incentiveContext=useIncentivesContext();var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),openDrawer=_useState4[0],setOpenDrawer=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),openCustomizationDrawer=_useState6[0],setOpenCustomizationDrawer=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),openCharityDrawer=_useState8[0],setOpenCharityDrawer=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),selectedIncentive=_useState10[0],setSelectedIncentive=_useState10[1];var _useGetPartnersAndInc=useGetPartnersAndIncentivesContext(),incentiveFromSalesForce=_useGetPartnersAndInc.incentiveFromSalesForce;var _useParams=useParams(),clientId=_useParams.clientId;var _useState11=useState(1),_useState12=_slicedToArray(_useState11,2),currentPage=_useState12[0],setCurrentPage=_useState12[1];var isMobile=useMediaQuery({maxWidth:610});var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),data=_useState14[0],setData=_useState14[1];var _useState15=useState([\"All\"]),_useState16=_slicedToArray(_useState15,2),activeCheckboxes=_useState16[0],setActiveCheckboxes=_useState16[1];var _useState17=useState(\"az\"),_useState18=_slicedToArray(_useState17,2),sortBy=_useState18[0],setSortBy=_useState18[1];var _useState19=useState([]),_useState20=_slicedToArray(_useState19,2),memberContactData=_useState20[0],setMemberContactData=_useState20[1];var _useState21=useState([]),_useState22=_slicedToArray(_useState21,2),contactData=_useState22[0],setContactData=_useState22[1];var _useState23=useState(false),_useState24=_slicedToArray(_useState23,2),loading=_useState24[0],setLoading=_useState24[1];var _useState25=useState({columnKey:\"incentive\",order:\"ascend\"}),_useState26=_slicedToArray(_useState25,2),sortedInfo=_useState26[0],setSortedInfo=_useState26[1];var cartItems=incentiveContext.cartItems;var filteredData=_toConsumableArray(incentiveFromSalesForce);if(activeCheckboxes.length&&!activeCheckboxes.includes(\"All\")){filteredData=filteredData.filter(function(item){return activeCheckboxes.includes(item.Product_Type__c);});}useEffect(function(){var processedData=_toConsumableArray(incentiveFromSalesForce);processedData.sort(function(a,b){return a.incentive.localeCompare(b.incentive);});if(activeCheckboxes.length&&!activeCheckboxes.includes(\"All\")){processedData=processedData.filter(function(item){return activeCheckboxes.includes(item.Product_Type__c);});}processedData=processedData.map(function(data){var _memberContactData$fi;return _objectSpread(_objectSpread({},data),{},{favorite:memberContactData===null||memberContactData===void 0?void 0:(_memberContactData$fi=memberContactData.find(function(d){return d.Incentive__c===data.key;}))===null||_memberContactData$fi===void 0?void 0:_memberContactData$fi.Favorite__c});});if(sortedInfo.columnKey){processedData.sort(function(a,b){if(sortBy===\"az\"){// Incentive name\nreturn a.incentive.localeCompare(b.incentive);}else if(sortBy===\"za\"){return b.incentive.localeCompare(a.incentive);}else if(sortBy===\"lowToHigh\"){return a.Points__c?b.Points__c?a.Points__c-b.Points__c:1:b.Points__c?-1:0;}else if(sortBy===\"highToLow\"){return a.Points__c?b.Points__c?b.Points__c-a.Points__c:-1:b.Points__c?1:0;}else{return new Date(b.CreatedDate||0).getTime()-new Date(a.CreatedDate||0).getTime();}});}var startIndex=(currentPage-1)*8;var endIndex=startIndex+8;var paginatedData=processedData.slice(0,endIndex);paginatedData=paginatedData.sort(sortByFavorite);setData(paginatedData);},[sortBy,currentPage,incentiveFromSalesForce,activeCheckboxes,memberContactData,sortedInfo.columnKey]);function fetchData(){return _fetchData.apply(this,arguments);}// Sorting function to prioritize 'favorite' status\nfunction _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(){var salesForceData;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return fetchDataFromSalesForce(\"query/?q=SELECT+Incentive_Copy__c,Favorite__c,Incentive__c,Id+FROM+Member_Incentive__c+WHERE+Member_Contact__c='\".concat(clientId,\"'\"));case 3:salesForceData=_context5.sent;setMemberContactData(salesForceData.records);getMemberInfoFromContact(\"\".concat(clientId)).then(function(res){setContactData(res);});console.log(\"--- contactData (Member Info)\",contactData);_context5.next=12;break;case 9:_context5.prev=9;_context5.t0=_context5[\"catch\"](0);console.error(\"Failed to fetch data:\",_context5.t0);case 12:case\"end\":return _context5.stop();}},_callee5,null,[[0,9]]);}));return _fetchData.apply(this,arguments);}var sortByFavorite=function sortByFavorite(a,b){if(a.favorite===\"Active\"&&b.favorite===\"Inactive\"){return-1;// 'active' comes before 'inactive'\n}else if(a.favorite===\"Inactive\"&&b.favorite===\"Active\"){return 1;// 'inactive' comes after 'active'\n}else{return 0;// no change in order\n}};useEffect(function(){void fetchData();},[]);var onCloseDrawer=function onCloseDrawer(){setSelectedIncentive(null);setOpenDrawer(false);};var onCloseCustomizationDrawer=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setOpenCustomizationDrawer(false);case 1:case\"end\":return _context.stop();}},_callee);}));return function onCloseCustomizationDrawer(){return _ref.apply(this,arguments);};}();var onSubmitCustomization=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(customizationString){var updatedData,index,updatedItem,updatedCartItems;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:updatedData={Customization__c:customizationString.toString()};// Find the index of the object in cartItems with the matching id\nindex=cartItems.findIndex(function(item){return item.cartItemId===selectCartItemId;});// If the object is found, update its Customization__c field\nif(index!==-1){updatedItem=_objectSpread(_objectSpread({},cartItems[index]),updatedData);// Merge updatedData with existing item data\nupdatedCartItems=_toConsumableArray(cartItems);// Create a copy of cartItems array\nupdatedCartItems[index]=updatedItem;// Replace the item at index with the updated one\nconsole.log(\"--- updatedCartItems\",updatedCartItems);// Update cartItems using incentiveContext.setCartItems\nincentiveContext.setCartItems(updatedCartItems);}else{console.log(\"Item not found in cartItems.\");}// if (id) {\n//   const result = await updateDataInSalesForce(\n//     `/sobjects/Member_Incentive__c/${id}`,\n//     updatedData\n//   );\n//   console.log(\"--- result\", result);\n//   console.log(memberContactData);\n// } else {\n//   console.error(\"No matching ID found for the selected incentive.\");\n// }\nsetOpenCustomizationDrawer(false);case 4:case\"end\":return _context2.stop();}},_callee2);}));return function onSubmitCustomization(_x){return _ref2.apply(this,arguments);};}();var onCloseCharityDrawer=function onCloseCharityDrawer(){setOpenCharityDrawer(false);};var showDrawer=function showDrawer(incentive){setSelectedIncentive(incentive);setOpenDrawer(true);};var handleChangePage=function handleChangePage(page){setCurrentPage(page);};var onLoadMore=function onLoadMore(){setCurrentPage(currentPage+1);};var addFavorite=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(e){var _memberContactData$fi2,id,updatedData,newData;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:setLoading(true);if(!memberContactData.find(function(m){return m.Incentive__c===e.key;})){_context3.next=10;break;}id=(_memberContactData$fi2=memberContactData.find(function(m){return m.Incentive__c===e.key;}))===null||_memberContactData$fi2===void 0?void 0:_memberContactData$fi2.Id;updatedData={Favorite__c:\"Active\"};_context3.next=6;return updateDataInSalesForce(\"/sobjects/Member_Incentive__c/\".concat(id),updatedData);case 6:fetchData();setLoading(false);_context3.next=15;break;case 10:newData={Member_Contact__c:clientId,Favorite__c:\"Active\",Incentive__c:e.key};_context3.next=13;return createDataInSalesForce(\"/sobjects/Member_Incentive__c/\",newData);case 13:fetchData();setLoading(false);case 15:case\"end\":return _context3.stop();}},_callee3);}));return function addFavorite(_x2){return _ref3.apply(this,arguments);};}();var cancelFavorite=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(e){var _memberContactData$fi3,id,updatedData;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:_context4.prev=0;id=(_memberContactData$fi3=memberContactData.find(function(m){return m.Incentive__c===e.key;}))===null||_memberContactData$fi3===void 0?void 0:_memberContactData$fi3.Id;if(!id){_context4.next=9;break;}setLoading(true);updatedData={Favorite__c:\"Inactive\"};_context4.next=7;return updateDataInSalesForce(\"/sobjects/Member_Incentive__c/\".concat(id),updatedData);case 7:fetchData();setLoading(false);case 9:_context4.next=14;break;case 11:_context4.prev=11;_context4.t0=_context4[\"catch\"](0);setLoading(false);case 14:case\"end\":return _context4.stop();}},_callee4,null,[[0,11]]);}));return function cancelFavorite(_x3){return _ref4.apply(this,arguments);};}();var columns=[{title:\"Incentive Name\",dataIndex:\"incentive\",key:\"incentive\"},{title:\"Website\",key:\"Website__c\",render:function render(value){return/*#__PURE__*/_jsx(\"div\",{style:{maxWidth:\"300px\"},children:value.Website__c});}},{title:\"Points\",dataIndex:\"Points__c\",key:\"Points__c\"},{title:\"Favorite\",key:\"favorite\",render:function render(value){// console.log('-- value', value, row)\nreturn/*#__PURE__*/_jsx(_Fragment,{children:(value===null||value===void 0?void 0:value.favorite)===\"Active\"?/*#__PURE__*/_jsx(StarFilled,{onClick:function onClick(){return cancelFavorite(value);}}):/*#__PURE__*/_jsx(StarOutlined,{onClick:function onClick(){return addFavorite(value);}})});}},{title:\"Add to Cart\",key:\"Points__c\",render:function render(value){return/*#__PURE__*/_jsx(Button,{onClick:function onClick(e){e.stopPropagation();setSelectedIncentive(value);onAddToCart(value);},children:\"Add to Cart\"});}}];var onAddToCart=function onAddToCart(value){console.log(\"---- cartitems: \",cartItems);console.log(\"--- value\",value);// Make changes to the item's properties\nif(value.Customization_Options__c){setOpenCustomizationDrawer(true);}if(value.Product_Type__c===\"Charitable\"){setOpenCharityDrawer(true);}// Generate a UUID for the cart item ID\nvar cartItemId=uuidv4();setSelectCartItemId(cartItemId);// Create a new object with the updated key and additional property incentiveId\nvar key=value.key,rest=_objectWithoutProperties(value,_excluded);// Destructure value, leaving out the key\nvar newValue=_objectSpread({incentiveId:key,key:cartItemId,cartItemId:cartItemId},rest);// Create new object with incentiveId, cartItemId, and remaining properties\n// Add the item to the cart\nincentiveContext.setCartItems([].concat(_toConsumableArray(cartItems),[newValue]));};var getCartCount=function getCartCount(value){var filteredCartItems=cartItems.filter(function(item){return item.incentiveId==value.key;});return filteredCartItems.length;};var removeCartItem=function removeCartItem(item){var filteredCartItems=cartItems.filter(function(c){return c.incentiveId==item.key;});filteredCartItems.pop();var deleted=cartItems.filter(function(c){return c.incentiveId!==item.key;});incentiveContext.setCartItems([].concat(_toConsumableArray(deleted),_toConsumableArray(filteredCartItems)));return filteredCartItems.length;};var menuValues=Array.from(new Set(incentiveFromSalesForce.map(function(item){return item.Product_Type__c;}))).sort(function(a,b){return a===null||a===void 0?void 0:a.localeCompare(b);});var menuItems=[\"All\"].concat(_toConsumableArray(menuValues));var menu=/*#__PURE__*/_jsx(Menu,{style:{maxHeight:\"250px\",overflowY:\"auto\"},children:menuItems.map(function(item,index){return/*#__PURE__*/_jsx(Menu.Item,{children:/*#__PURE__*/_jsx(Checkbox,{checked:activeCheckboxes.includes(item),onClick:function onClick(e){return handleFilterChange(e,item);},children:item})},index);})});var handleFilterChange=function handleFilterChange(event,category){event.stopPropagation();// Останавливаем распространение события\nvar updatedCheckboxes=_toConsumableArray(activeCheckboxes);if(category===\"All\"){updatedCheckboxes=[\"All\"];}else{if(updatedCheckboxes.includes(\"All\")){updatedCheckboxes=[];}if(updatedCheckboxes.includes(category)){updatedCheckboxes=updatedCheckboxes.filter(function(item){return item!==category;});}else{updatedCheckboxes.push(category);}}setActiveCheckboxes(updatedCheckboxes);};var handleMenuClick=function handleMenuClick(e){// message.info('Click on menu item.');\nconsole.log(\"click\",e);setSortBy(e.key);};var items=[{label:\"Sort A-Z\",key:\"az\"},{label:\"Sort Z-A\",key:\"za\"},{label:\"Points Low to High\",key:\"lowToHigh\"},{label:\"Points High to Low\",key:\"highToLow\"},{label:\"Newest First\",key:\"newestFirst\"}];var menuProps={items:items,onClick:handleMenuClick};console.log(\"--- data: \",data);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"section\",{className:styles.incentivesTableContainer,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.incentivesTableHeaderContainer,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.incentivesTitleContainer,children:[/*#__PURE__*/_jsx(Dropdown,{menu:menuProps,trigger:[\"click\"],children:/*#__PURE__*/_jsx(Button,{className:styles.sortBtn,children:/*#__PURE__*/_jsxs(Space,{children:[\"Sort by\",/*#__PURE__*/_jsx(DownOutlined,{})]})})}),/*#__PURE__*/_jsx(Dropdown,{overlay:menu,trigger:[\"click\"],children:/*#__PURE__*/_jsxs(\"button\",{className:styles.filterBtn,children:[/*#__PURE__*/_jsx(Filter,{}),\" Filter\"]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.pointsBalanceContainer,children:[/*#__PURE__*/_jsxs(\"h3\",{children:[/*#__PURE__*/_jsx(\"span\",{className:styles.pointsBalanceLabel,children:\"Points Balance:\"}),\" \",NumberWithCommas(contactData===null||contactData===void 0?void 0:contactData.Points_Balance__c)]}),/*#__PURE__*/_jsx(Link,{target:\"_blank\",href:\"https://form.jotform.com/240324768989170\",children:/*#__PURE__*/_jsx(\"p\",{className:styles.suggestIncentiveText,children:\"Suggest an Incentive\"})})]})]}),/*#__PURE__*/_jsx(Row,{gutter:[32,32],className:styles.incentivesItemsContainer,children:data.map(function(item){return/*#__PURE__*/_jsxs(Col,{md:6,sm:12,xs:12,className:styles.incentivesItemContainer,children:[/*#__PURE__*/_jsxs(\"div\",{style:{position:\"relative\",width:\"100%\"},children:[/*#__PURE__*/_jsx(Image,{width:\"100%\",src:item.Image__c||\"https://via.placeholder.com/200\",alt:\"Your Image\"}),(item===null||item===void 0?void 0:item.favorite)===\"Active\"?/*#__PURE__*/_jsx(StarFilled,{className:styles.favoriteBtn,onClick:function onClick(){return cancelFavorite(item);}}):/*#__PURE__*/_jsx(StarOutlined,{className:styles.favoriteBtn,onClick:function onClick(){return addFavorite(item);}})]}),!getCartCount(item)&&/*#__PURE__*/_jsx(Button,{className:styles.addToCartBtn,onClick:function onClick(e){e.stopPropagation();setSelectedIncentive(item);onAddToCart(item);},children:\"+ Add\"}),getCartCount(item)>0&&/*#__PURE__*/_jsxs(Button,{className:styles.addToCartBtn,onClick:function onClick(e){e.stopPropagation();setSelectedIncentive(item);},children:[/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return removeCartItem(item);},className:styles.cartItemActionBtn,children:\"-\"}),getCartCount(item),/*#__PURE__*/_jsx(\"span\",{className:styles.cartItemActionBtn,onClick:function onClick(){return onAddToCart(item);},children:\"+\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.incentivesItemInfoContainer,children:[/*#__PURE__*/_jsx(Link,{target:\"_blank\",href:item.Website__c,className:styles.incentivesItemWebsiteText,children:item.incentive}),/*#__PURE__*/_jsxs(\"p\",{className:styles.incentivesItemPointsText,children:[item.Points__c,\" points\"]})]}),/*#__PURE__*/_jsx(\"hr\",{className:styles.divider})]},item.key);})}),/*#__PURE__*/_jsx(\"div\",{className:styles.loadMoreContainer,onClick:function onClick(){return onLoadMore();},children:/*#__PURE__*/_jsx(Button,{children:\"Load More\"})}),/*#__PURE__*/_jsx(SelectedIncentivesDrawer,{selectedIncentivesDetails:selectedIncentive,isOpen:openDrawer,onClose:onCloseDrawer}),/*#__PURE__*/_jsx(IncentiveCustomizationDrawer,{isOpen:openCustomizationDrawer,onClose:onCloseCustomizationDrawer,onSubmit:onSubmitCustomization}),/*#__PURE__*/_jsx(CharityDrawer,{isOpen:openCharityDrawer,onClose:onCloseCharityDrawer,contactInfo:contactData})]})});};export default SelectedIncentivesSection;","map":{"version":3,"names":["React","useEffect","useState","useMediaQuery","Button","Checkbox","Col","Dropdown","Image","Menu","Row","Space","useGetPartnersAndIncentivesContext","useIncentivesContext","ReactComponent","Filter","v4","uuidv4","styles","DownOutlined","StarFilled","StarOutlined","SelectedIncentivesDrawer","useParams","createDataInSalesForce","fetchDataFromSalesForce","updateDataInSalesForce","IncentiveCustomizationDrawer","getMemberInfoFromContact","CharityDrawer","Link","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","NumberWithCommas","x","toString","replace","SelectedIncentivesSection","_useState","_useState2","_slicedToArray","selectCartItemId","setSelectCartItemId","incentiveContext","_useState3","_useState4","openDrawer","setOpenDrawer","_useState5","_useState6","openCustomizationDrawer","setOpenCustomizationDrawer","_useState7","_useState8","openCharityDrawer","setOpenCharityDrawer","_useState9","_useState10","selectedIncentive","setSelectedIncentive","_useGetPartnersAndInc","incentiveFromSalesForce","_useParams","clientId","_useState11","_useState12","currentPage","setCurrentPage","isMobile","maxWidth","_useState13","_useState14","data","setData","_useState15","_useState16","activeCheckboxes","setActiveCheckboxes","_useState17","_useState18","sortBy","setSortBy","_useState19","_useState20","memberContactData","setMemberContactData","_useState21","_useState22","contactData","setContactData","_useState23","_useState24","loading","setLoading","_useState25","columnKey","order","_useState26","sortedInfo","setSortedInfo","cartItems","filteredData","_toConsumableArray","length","includes","filter","item","Product_Type__c","processedData","sort","a","b","incentive","localeCompare","map","_memberContactData$fi","_objectSpread","favorite","find","d","Incentive__c","key","Favorite__c","Points__c","Date","CreatedDate","getTime","startIndex","endIndex","paginatedData","slice","sortByFavorite","fetchData","_fetchData","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee5","salesForceData","wrap","_callee5$","_context5","prev","next","concat","sent","records","then","res","console","log","t0","error","stop","onCloseDrawer","onCloseCustomizationDrawer","_ref","_callee","_callee$","_context","onSubmitCustomization","_ref2","_callee2","customizationString","updatedData","index","updatedItem","updatedCartItems","_callee2$","_context2","Customization__c","findIndex","cartItemId","setCartItems","_x","onCloseCharityDrawer","showDrawer","handleChangePage","page","onLoadMore","addFavorite","_ref3","_callee3","e","_memberContactData$fi2","id","newData","_callee3$","_context3","m","Id","Member_Contact__c","_x2","cancelFavorite","_ref4","_callee4","_memberContactData$fi3","_callee4$","_context4","_x3","columns","title","dataIndex","render","value","style","children","Website__c","onClick","stopPropagation","onAddToCart","Customization_Options__c","rest","_objectWithoutProperties","_excluded","newValue","incentiveId","getCartCount","filteredCartItems","removeCartItem","c","pop","deleted","menuValues","Array","from","Set","menuItems","menu","maxHeight","overflowY","Item","checked","handleFilterChange","event","category","updatedCheckboxes","push","handleMenuClick","items","label","menuProps","className","incentivesTableContainer","incentivesTableHeaderContainer","incentivesTitleContainer","trigger","sortBtn","overlay","filterBtn","pointsBalanceContainer","pointsBalanceLabel","Points_Balance__c","target","href","suggestIncentiveText","gutter","incentivesItemsContainer","md","sm","xs","incentivesItemContainer","position","width","src","Image__c","alt","favoriteBtn","addToCartBtn","cartItemActionBtn","incentivesItemInfoContainer","incentivesItemWebsiteText","incentivesItemPointsText","divider","loadMoreContainer","selectedIncentivesDetails","isOpen","onClose","onSubmit","contactInfo"],"sources":["/Users/shannoncoakley/Documents/GitHub/mp/memberportal/src/components/sections/incentivesSection/SelectedIncentivesSection.tsx"],"sourcesContent":["import React, { FC, useEffect, useState } from \"react\";\nimport { useMediaQuery } from \"react-responsive\";\nimport {\n  Button,\n  Checkbox,\n  Col,\n  Dropdown,\n  Image,\n  List,\n  Menu,\n  MenuProps,\n  Pagination,\n  Row,\n  Space,\n  Table,\n  Tag,\n} from \"antd\";\nimport type { ColumnsType, SorterResult } from \"antd/es/table/interface\";\nimport {\n  GetIncentiveDataType,\n  useGetPartnersAndIncentivesContext,\n  useIncentivesContext,\n  usePartnerContext,\n} from \"../homeSection/contexts/IncentivesContext\";\nimport { ReactComponent as Filter } from \"../../../images/svgIcons/filter.svg\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport styles from \"./styles.module.sass\";\nimport { DownOutlined, StarFilled, StarOutlined } from \"@ant-design/icons\";\nimport SelectedIncentivesDrawer from \"./SelectedIncentivesDrawer\";\nimport { useParams } from \"react-router-dom\";\nimport {\n  createDataInSalesForce,\n  fetchDataFromSalesForce,\n  updateDataInSalesForce,\n} from \"../../../salesforceAuth\";\nimport IncentiveCustomizationDrawer from \"./IncentiveCustomizationDrawer\";\nimport { getMemberInfoFromContact } from \"../../../getSalesForceData\";\nimport CharityDrawer from \"./CharityDrawer\";\nimport Link from \"antd/es/typography/Link\";\n\nexport interface SelectedIncentivesDataType {\n  key: string;\n  incentive: string;\n  moreInfo: string | JSX.Element;\n  meetingsRequired: number;\n  requirementsFulfilled?: string | JSX.Element;\n  status?: string | JSX.Element;\n  Meetings_Needed__c?: string;\n  Meetings_Completed__c?: string;\n  Customization__c?: string;\n  Points__c?: number;\n  Website__c?: string;\n  Image__c?: string;\n  favorite?: string;\n  cartItemId?: string;\n  Needs_to_be_shipped__c?: boolean;\n  incentiveId?: string;\n}\n\nconst NumberWithCommas = (x: number) => {\n  return x?.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n};\n\nconst SelectedIncentivesSection: FC = () => {\n  const [selectCartItemId, setSelectCartItemId] = useState<string>(\"\");\n  const incentiveContext = useIncentivesContext();\n  const [openDrawer, setOpenDrawer] = useState(false);\n  const [openCustomizationDrawer, setOpenCustomizationDrawer] = useState(false);\n  const [openCharityDrawer, setOpenCharityDrawer] = useState(false);\n  const [selectedIncentive, setSelectedIncentive] =\n    useState<SelectedIncentivesDataType | null>(null);\n  const { incentiveFromSalesForce } = useGetPartnersAndIncentivesContext();\n  const { clientId } = useParams<{ clientId: string }>();\n  const [currentPage, setCurrentPage] = useState(1);\n  const isMobile = useMediaQuery({ maxWidth: 610 });\n  const [data, setData] = useState<SelectedIncentivesDataType[]>([]);\n  const [activeCheckboxes, setActiveCheckboxes] = useState<string[]>([\"All\"]);\n  const [sortBy, setSortBy] = useState(\"az\");\n  const [memberContactData, setMemberContactData] = useState<any[]>([]);\n  const [contactData, setContactData] = useState<any>([]);\n  const [loading, setLoading] = useState(false);\n  const [sortedInfo, setSortedInfo] = useState<\n    SorterResult<GetIncentiveDataType>\n  >({\n    columnKey: \"incentive\",\n    order: \"ascend\",\n  });\n  const cartItems = incentiveContext.cartItems;\n\n  let filteredData = [...incentiveFromSalesForce];\n\n  if (activeCheckboxes.length && !activeCheckboxes.includes(\"All\")) {\n    filteredData = filteredData.filter((item) =>\n      activeCheckboxes.includes(item.Product_Type__c)\n    );\n  }\n\n  useEffect(() => {\n    let processedData = [...incentiveFromSalesForce];\n\n    processedData.sort((a, b) => a.incentive.localeCompare(b.incentive));\n\n    if (activeCheckboxes.length && !activeCheckboxes.includes(\"All\")) {\n      processedData = processedData.filter((item) =>\n        activeCheckboxes.includes(item.Product_Type__c)\n      );\n    }\n\n    processedData = processedData.map((data) => ({\n      ...data,\n      favorite: memberContactData?.find((d) => d.Incentive__c === data.key)\n        ?.Favorite__c,\n    }));\n\n    if (sortedInfo.columnKey) {\n      processedData.sort((a, b) => {\n        if (sortBy === \"az\") {\n          // Incentive name\n          return a.incentive.localeCompare(b.incentive);\n        } else if (sortBy === \"za\") {\n          return b.incentive.localeCompare(a.incentive);\n        } else if (sortBy === \"lowToHigh\") {\n          return a.Points__c\n            ? b.Points__c\n              ? a.Points__c - b.Points__c\n              : 1\n            : b.Points__c\n            ? -1\n            : 0;\n        } else if (sortBy === \"highToLow\") {\n          return a.Points__c\n            ? b.Points__c\n              ? b.Points__c - a.Points__c\n              : -1\n            : b.Points__c\n            ? 1\n            : 0;\n        } else {\n          return (\n            new Date(b.CreatedDate || 0).getTime() -\n            new Date(a.CreatedDate || 0).getTime()\n          );\n        }\n      });\n    }\n\n    const startIndex = (currentPage - 1) * 8;\n    const endIndex = startIndex + 8;\n    let paginatedData = processedData.slice(0, endIndex);\n    paginatedData = paginatedData.sort(sortByFavorite);\n    setData(paginatedData);\n  }, [\n    sortBy,\n    currentPage,\n    incentiveFromSalesForce,\n    activeCheckboxes,\n    memberContactData,\n    sortedInfo.columnKey,\n  ]);\n\n  async function fetchData() {\n    try {\n      const salesForceData = await fetchDataFromSalesForce(\n        `query/?q=SELECT+Incentive_Copy__c,Favorite__c,Incentive__c,Id+FROM+Member_Incentive__c+WHERE+Member_Contact__c='${clientId}'`\n      );\n      setMemberContactData(salesForceData.records);\n      getMemberInfoFromContact(`${clientId}`).then((res) => {\n        setContactData(res);\n      });\n      console.log(\"--- contactData (Member Info)\", contactData);\n    } catch (error) {\n      console.error(\"Failed to fetch data:\", error);\n    }\n  }\n\n  // Sorting function to prioritize 'favorite' status\n  const sortByFavorite = (a: any, b: any) => {\n    if (a.favorite === \"Active\" && b.favorite === \"Inactive\") {\n      return -1; // 'active' comes before 'inactive'\n    } else if (a.favorite === \"Inactive\" && b.favorite === \"Active\") {\n      return 1; // 'inactive' comes after 'active'\n    } else {\n      return 0; // no change in order\n    }\n  };\n\n  useEffect(() => {\n    void fetchData();\n  }, []);\n\n  const onCloseDrawer = () => {\n    setSelectedIncentive(null);\n    setOpenDrawer(false);\n  };\n\n  const onCloseCustomizationDrawer = async () => {\n    setOpenCustomizationDrawer(false);\n  };\n\n  const onSubmitCustomization = async (customizationString: string) => {\n    const updatedData = {\n      Customization__c: customizationString.toString(),\n    };\n\n    // Find the index of the object in cartItems with the matching id\n    const index = cartItems.findIndex(\n      (item) => item.cartItemId === selectCartItemId\n    );\n\n    // If the object is found, update its Customization__c field\n    if (index !== -1) {\n      const updatedItem = { ...cartItems[index], ...updatedData }; // Merge updatedData with existing item data\n      const updatedCartItems = [...cartItems]; // Create a copy of cartItems array\n      updatedCartItems[index] = updatedItem; // Replace the item at index with the updated one\n      console.log(\"--- updatedCartItems\", updatedCartItems);\n\n      // Update cartItems using incentiveContext.setCartItems\n      incentiveContext.setCartItems(updatedCartItems);\n    } else {\n      console.log(\"Item not found in cartItems.\");\n    }\n\n    // if (id) {\n    //   const result = await updateDataInSalesForce(\n    //     `/sobjects/Member_Incentive__c/${id}`,\n    //     updatedData\n    //   );\n    //   console.log(\"--- result\", result);\n    //   console.log(memberContactData);\n    // } else {\n    //   console.error(\"No matching ID found for the selected incentive.\");\n    // }\n    setOpenCustomizationDrawer(false);\n  };\n\n  const onCloseCharityDrawer = () => {\n    setOpenCharityDrawer(false);\n  };\n\n  const showDrawer = (incentive: SelectedIncentivesDataType) => {\n    setSelectedIncentive(incentive);\n    setOpenDrawer(true);\n  };\n\n  const handleChangePage = (page: number) => {\n    setCurrentPage(page);\n  };\n\n  const onLoadMore = () => {\n    setCurrentPage(currentPage + 1);\n  };\n\n  const addFavorite = async (e: any) => {\n    setLoading(true);\n    if (memberContactData.find((m) => m.Incentive__c === e.key)) {\n      const id = memberContactData.find((m) => m.Incentive__c === e.key)?.Id;\n      const updatedData = {\n        Favorite__c: \"Active\",\n      };\n      await updateDataInSalesForce(\n        `/sobjects/Member_Incentive__c/${id}`,\n        updatedData\n      );\n      fetchData();\n      setLoading(false);\n    } else {\n      const newData = {\n        Member_Contact__c: clientId,\n        Favorite__c: \"Active\",\n        Incentive__c: e.key,\n      };\n      await createDataInSalesForce(`/sobjects/Member_Incentive__c/`, newData);\n      fetchData();\n      setLoading(false);\n    }\n  };\n\n  const cancelFavorite = async (e: any) => {\n    try {\n      const id = memberContactData.find((m) => m.Incentive__c === e.key)?.Id;\n      if (id) {\n        setLoading(true);\n        const updatedData = {\n          Favorite__c: \"Inactive\",\n        };\n        await updateDataInSalesForce(\n          `/sobjects/Member_Incentive__c/${id}`,\n          updatedData\n        );\n        fetchData();\n        setLoading(false);\n      }\n    } catch (error) {\n      setLoading(false);\n    }\n  };\n\n  const columns: ColumnsType<SelectedIncentivesDataType> = [\n    {\n      title: \"Incentive Name\",\n      dataIndex: \"incentive\",\n      key: \"incentive\",\n    },\n    {\n      title: \"Website\",\n      key: \"Website__c\",\n      render: (value) => (\n        <div style={{ maxWidth: \"300px\" }}>{value.Website__c}</div>\n      ),\n    },\n    {\n      title: \"Points\",\n      dataIndex: \"Points__c\",\n      key: \"Points__c\",\n    },\n    {\n      title: \"Favorite\",\n      key: \"favorite\",\n      render: (value) => {\n        // console.log('-- value', value, row)\n        return (\n          <>\n            {value?.favorite === \"Active\" ? (\n              <StarFilled onClick={() => cancelFavorite(value)} />\n            ) : (\n              <StarOutlined onClick={() => addFavorite(value)} />\n            )}\n          </>\n        );\n      },\n    },\n    {\n      title: \"Add to Cart\",\n      key: \"Points__c\",\n      render: (value) => {\n        return (\n          <Button\n            onClick={(e) => {\n              e.stopPropagation();\n              setSelectedIncentive(value);\n              onAddToCart(value);\n            }}\n          >\n            Add to Cart\n          </Button>\n        );\n      },\n    },\n  ];\n\n  const onAddToCart = (value: any) => {\n    console.log(\"---- cartitems: \", cartItems);\n    console.log(\"--- value\", value);\n\n    // Make changes to the item's properties\n    if (value.Customization_Options__c) {\n      setOpenCustomizationDrawer(true);\n    }\n    if (value.Product_Type__c === \"Charitable\") {\n      setOpenCharityDrawer(true);\n    }\n\n    // Generate a UUID for the cart item ID\n    const cartItemId = uuidv4();\n    setSelectCartItemId(cartItemId);\n    // Create a new object with the updated key and additional property incentiveId\n    const { key, ...rest } = value; // Destructure value, leaving out the key\n    const newValue = { incentiveId: key, key: cartItemId, cartItemId, ...rest }; // Create new object with incentiveId, cartItemId, and remaining properties\n\n    // Add the item to the cart\n    incentiveContext.setCartItems([...cartItems, newValue]);\n  };\n\n  const getCartCount = (value: any) => {\n    const filteredCartItems = cartItems.filter(\n      (item) => item.incentiveId == value.key\n    );\n    return filteredCartItems.length;\n  };\n\n  const removeCartItem = (item: any) => {\n    const filteredCartItems = cartItems.filter(\n      (c) => c.incentiveId == item.key\n    );\n    filteredCartItems.pop();\n    const deleted = cartItems.filter((c) => c.incentiveId !== item.key);\n    incentiveContext.setCartItems([...deleted, ...filteredCartItems]);\n    return filteredCartItems.length;\n  };\n\n  const menuValues = Array.from(\n    new Set(incentiveFromSalesForce.map((item) => item.Product_Type__c))\n  ).sort((a: any, b: any) => a?.localeCompare(b));\n  const menuItems = [\"All\", ...menuValues];\n  const menu = (\n    <Menu style={{ maxHeight: \"250px\", overflowY: \"auto\" }}>\n      {menuItems.map((item, index) => (\n        <Menu.Item key={index}>\n          <Checkbox\n            checked={activeCheckboxes.includes(item)}\n            onClick={(e) => handleFilterChange(e, item)}\n          >\n            {item}\n          </Checkbox>\n        </Menu.Item>\n      ))}\n    </Menu>\n  );\n\n  const handleFilterChange = (event: React.MouseEvent, category: string) => {\n    event.stopPropagation(); // Останавливаем распространение события\n\n    let updatedCheckboxes = [...activeCheckboxes];\n\n    if (category === \"All\") {\n      updatedCheckboxes = [\"All\"];\n    } else {\n      if (updatedCheckboxes.includes(\"All\")) {\n        updatedCheckboxes = [];\n      }\n      if (updatedCheckboxes.includes(category)) {\n        updatedCheckboxes = updatedCheckboxes.filter(\n          (item) => item !== category\n        );\n      } else {\n        updatedCheckboxes.push(category);\n      }\n    }\n\n    setActiveCheckboxes(updatedCheckboxes);\n  };\n\n  const handleMenuClick: MenuProps[\"onClick\"] = (e) => {\n    // message.info('Click on menu item.');\n    console.log(\"click\", e);\n    setSortBy(e.key);\n  };\n\n  const items: MenuProps[\"items\"] = [\n    {\n      label: \"Sort A-Z\",\n      key: \"az\",\n    },\n    {\n      label: \"Sort Z-A\",\n      key: \"za\",\n    },\n    {\n      label: \"Points Low to High\",\n      key: \"lowToHigh\",\n    },\n    {\n      label: \"Points High to Low\",\n      key: \"highToLow\",\n    },\n    {\n      label: \"Newest First\",\n      key: \"newestFirst\",\n    },\n  ];\n\n  const menuProps = {\n    items,\n    onClick: handleMenuClick,\n  };\n\n  console.log(\"--- data: \", data);\n\n  return (\n    <>\n      <section className={styles.incentivesTableContainer}>\n        <div className={styles.incentivesTableHeaderContainer}>\n          <div className={styles.incentivesTitleContainer}>\n            <Dropdown menu={menuProps} trigger={[\"click\"]}>\n              <Button className={styles.sortBtn}>\n                <Space>\n                  Sort by\n                  <DownOutlined />\n                </Space>\n              </Button>\n            </Dropdown>\n            <Dropdown overlay={menu} trigger={[\"click\"]}>\n              <button className={styles.filterBtn}>\n                <Filter /> Filter\n              </button>\n            </Dropdown>\n          </div>\n          <div className={styles.pointsBalanceContainer}>\n            <h3>\n              <span className={styles.pointsBalanceLabel}>Points Balance:</span>{\" \"}\n              {NumberWithCommas(contactData?.Points_Balance__c)}\n            </h3>\n            <Link\n              target=\"_blank\"\n              href=\"https://form.jotform.com/240324768989170\"\n            >\n              <p className={styles.suggestIncentiveText}>\n                Suggest an Incentive\n              </p>\n            </Link>\n          </div>\n        </div>\n        <Row gutter={[32, 32]} className={styles.incentivesItemsContainer}>\n          {data.map((item) => (\n            <Col\n              key={item.key}\n              md={6}\n              sm={12}\n              xs={12}\n              className={styles.incentivesItemContainer}\n            >\n              <div style={{ position: \"relative\", width: \"100%\" }}>\n                <Image\n                  width=\"100%\"\n                  src={item.Image__c || \"https://via.placeholder.com/200\"}\n                  alt=\"Your Image\"\n                />\n                {item?.favorite === \"Active\" ? (\n                  <StarFilled\n                    className={styles.favoriteBtn}\n                    onClick={() => cancelFavorite(item)}\n                  />\n                ) : (\n                  <StarOutlined\n                    className={styles.favoriteBtn}\n                    onClick={() => addFavorite(item)}\n                  />\n                )}\n              </div>\n              {!getCartCount(item) && (\n                <Button\n                  className={styles.addToCartBtn}\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    setSelectedIncentive(item);\n                    onAddToCart(item);\n                  }}\n                >\n                  + Add\n                </Button>\n              )}\n\n              {getCartCount(item) > 0 && (\n                <Button\n                  className={styles.addToCartBtn}\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    setSelectedIncentive(item);\n                  }}\n                >\n                  <span\n                    onClick={() => removeCartItem(item)}\n                    className={styles.cartItemActionBtn}\n                  >\n                    -\n                  </span>\n                  {getCartCount(item)}\n                  <span\n                    className={styles.cartItemActionBtn}\n                    onClick={() => onAddToCart(item)}\n                  >\n                    +\n                  </span>\n                </Button>\n              )}\n              <div className={styles.incentivesItemInfoContainer}>\n                <Link\n                  target=\"_blank\"\n                  href={item.Website__c}\n                  className={styles.incentivesItemWebsiteText}\n                >\n                  {item.incentive}\n                </Link>\n                <p className={styles.incentivesItemPointsText}>\n                  {item.Points__c} points\n                </p>\n              </div>\n              <hr className={styles.divider} />\n            </Col>\n          ))}\n        </Row>\n        <div className={styles.loadMoreContainer} onClick={() => onLoadMore()}>\n          <Button>Load More</Button>\n        </div>\n        <SelectedIncentivesDrawer\n          selectedIncentivesDetails={selectedIncentive}\n          isOpen={openDrawer}\n          onClose={onCloseDrawer}\n        />\n        <IncentiveCustomizationDrawer\n          isOpen={openCustomizationDrawer}\n          onClose={onCloseCustomizationDrawer}\n          onSubmit={onSubmitCustomization}\n        />\n        <CharityDrawer\n          isOpen={openCharityDrawer}\n          onClose={onCloseCharityDrawer}\n          contactInfo={contactData}\n        />\n      </section>\n    </>\n  );\n};\n\nexport default SelectedIncentivesSection;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}